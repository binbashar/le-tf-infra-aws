#
# Providers
#
provider "aws" {
  region                  = var.region
  profile                 = var.profile
  shared_credentials_file = "~/.aws/${var.project}/config"
}

provider "helm" {
  kubernetes {
    #### EKS
    # host                   = data.aws_eks_cluster.cluster.endpoint
    # cluster_ca_certificate = base64decode(data.aws_eks_cluster.cluster.certificate_authority.0.data)
    # token                  = data.aws_eks_cluster_auth.cluster.token

    #### Kind (local)
    host                   = "https://192.168.0.85:6443"
    cluster_ca_certificate = base64decode("LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUM1ekNDQWMrZ0F3SUJBZ0lCQURBTkJna3Foa2lHOXcwQkFRc0ZBREFWTVJNd0VRWURWUVFERXdwcmRXSmwKY201bGRHVnpNQjRYRFRJeE1EUXdPVEl6TVRjd01Gb1hEVE14TURRd056SXpNVGN3TUZvd0ZURVRNQkVHQTFVRQpBeE1LYTNWaVpYSnVaWFJsY3pDQ0FTSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBTVM0Cnpna1NONUlTVTF1R1JmU0h5M3dsRTRoMGRUREljRnZlL21JdXduZ2hNaWVTd3JLUkttRFQ3T2RJY3hyT0srS1QKZS9lR1Y4UHVEV21FejFpL3oyNGF1YVNYUmlJZEhsZWdkclpMRzIxc21wbTBsN3hybGRZT0ttWG9MV2VHUEJNTwp5Tm1TM3hZc1hMN2V6WHdzT0pTTUV4Rzh6dW0vQkFMT3RRWFB4K2N0d0lzNjRSektSUkEvUkVWeW1QZFd3cVY5CktCemRlRytiUnF6d2ZkK0x5RGM5bUJ4UExrcTFoalZPc1NNQlR6aGJ0dzlmcXJNN3lTU0FRNllZbm1nS2xLYVEKQ1JCeUJNYWh3R0ZqVnNYVEdBTXVRaWt4NUk0NDF3SW9TTER3cWxiQzMvbnFud0lINURZZndma3NrTjFmNVRNcApvQy9LTVZRcE45cWZ0cE5yN0FNQ0F3RUFBYU5DTUVBd0RnWURWUjBQQVFIL0JBUURBZ0trTUE4R0ExVWRFd0VCCi93UUZNQU1CQWY4d0hRWURWUjBPQkJZRUZPK2hFeTRyazNXMzJ4VGRMREFOR25CSGUzbldNQTBHQ1NxR1NJYjMKRFFFQkN3VUFBNElCQVFCVGluNFV3ZTA4MEZuQ0g4dTgzcFF0VlNIaExuMmcweHZSejEreXpQZEVZSk9GYXYxWgpldkx0eHpBMWl3STBTaVJZb2JLY1lEZVFRMFdKNGJaQXVBc3pQUDBGSDBQR1ZpZ0dJc3AyM0VwWEdoSnNnUkhPClR2bW5ZYU5aUE5OMXhrRG5YaFFRalllQVA5cDFPUWVlY0srbW1xb1dZUVFRd0tKRmNVeHhTY1p0enZ6dU84c1UKL3g2WGxxYmYwNjJadUxGT3hUY1cyMy9GZXFjNDVucHR1LzRhWUwyaVcxUU80U2VRSlhFbjlOSU5tdXZnQ2oxMgpQOGsxdEl5U2JNUytIVGhYWHBSa2dvWkVzUEV6NC9BREZFZWw1VDNwVzdnL2NUR0hYWHltem5lakEzUDJJREZqCmdEQlhHUUNtRGNkODFFQ1h0OFJIcFgvMFh2M1JrUFlnR0x5aQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==")
    client_key             = base64decode("LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBMVBFK2FTMDFkUHoyQ3dPZzVmOW1nUmQzUnJ4WW5qYm56TUE3MFdRU0ljSHZBaUY2Ckhjc29YeWUvT3VzOGgyQkpDUDE3NDVtY1NiSFcwSE5jaTI3RUw5VjNWLzY3TEtmK1d0QlBTNXVBS2pUQ0tMMjYKbnF5QjBSYkh1M29wVGc5eHg4SW1VTWxvUU9LVVFCQnYzTmExdmVKWlFORjhEbkpVNTBvM0NRL3UrM3N1YitWKwo0RGtaOHNOeFVnUzJPenA3SzlIbFlJcFhvT0pQSFgxcndOa3gwK3YvaVlQaEkvZUZFd2VvMUtOMzVxY3Y0Y2dWCmRETHVsYVdMelY1ZzlyTUdRRW5CRmlleElrdHUydFovMVRZaGdHdGJ4TC9ZOFp6WU41VFFkTG1ZVVJHR1ZXN0EKMFJtcnhzYXIxaXRkZzFRVzBLbE5DTGZuUjdtMEVHcHZmQXg3dHdJREFRQUJBb0lCQVFDNVM0T0hlak4rTFhEYwpmTGZSNjhDQ3JLeTUvTU1RU2E3RFdMTzByV09weEZ2NmVxOE1wZS9uZldyR0ZsU0JhS09sRXc1dkt3ZjRpS3ZvCmo3b0VDc3JrNU5nSTFqeUJ5MTFtSU1ZZmdKeXlIVjZtblJKN2FKaytISmlJNXZCeVlMWWRvVEErTkVSbjBjSTMKVFJaS0VQdnMwNzNleldzcUZ3c1NpRjREb0wzUVRmWEtnNXNhOXE0a3hLTG13cFFpM0FucmJ1VWwxZ3A2NGFPYQpGbXc3bDVrY3lzaWpNazBtZk1naHc5bzJtVDQyNjIxY2E5YmhlbzRsT3pwUCsvM0ZLQzBqLzVaTmJkRnphRGRZCjEzYjN5SnV2NFlNa0k5VDZCMjRlTmdOUGJjUFkvUVhJRWE2T1AwTk1ER0p2MjAzTEtyak5DVG9LdVpqUjViQksKdThlVWlNS0JBb0dCQU8vT016aEg5VHZ4Ulp1dVpRemd6M3dmZnpnQit1SzhMK0oyMWE4ZENZTXIvZXQ4RTJwVwpjSjVSSXEyZkFndU9TQTdpeTBwbTVUc1Bad0VTczcxYVpRV1Z2OVRlU2FKK3dXWXpodFB2cnIwMitobGZzQVM3CjlGaWxWaTNGNlpIQitsQnlQKzRBSFNyWU13Y3I3bVh1ODVQWVFWdEpLZXJVdmowdWhjVWFFN0duQW9HQkFPTlMKb1NOczIzS1R0cVlxZkRpZVR5U1VLRG4yV012K2hHMS9CRnluMFBRM1UrczZ1cllCTnNCbzR0elJHTXFxOWxYOApNdXA4dHZHUVN5WXR1QWJHNDBkNzlSZWhxZ2FFWlZaUEZJK1ZUWTY3bnF5NUxEci85N2hPSG1FbmxKZ2Qyd3VQClhjUlRlNmxvZHRBQ2lkUnBGU0hQbmwrVi9PY256b3ZmQlJvUmRJZHhBb0dCQU5nSVN0eEk5d1FwTnl3b3o1L3EKWndESzN6RDFsNjdyR2JoS2xmWkxrbVk1RzJjcFA5UnNTc2hWRDRpWjFwM1NiOWY1T0dxdWg1UE5MRjRyR3dGYQpqZWVhSUZjRWFoR1pYMkZTeWdQanlPZHN2NkpjTVpZU1BPNGZCS1AzeDVNbnpQanI4K3ZVN25IS2t5M0N4ZUhPCmdtQ09VVktMZHRlM0VDck4zblRTS1N2QkFvR0FQM2NkUjkrbmNOaXVvTHV4ekxqZURhOVRmOE00VFZPMHMwRkgKL1hwWXl5WDdSdXd4bm9pK09YL08vcWxlQzQ4cGtSNEZOUlEybTBDV3lvVHZJTzA4SFFRTmpGaDFPTGFUK0VIQgowc2h6UzhzejVMTWFGeXJKaFdwQjd3djIzM1ZPWjI3U1ZmS2N6dEk4Z1p5RDBJcTUvS09UYXNwY1Bra04wRjBtCmRuMnpFL0VDZ1lCL25oczBBVWU1V2g5cmtmTWE2clJXb3NoMDRzUGgrT2hWMnk1eXNOU2wwY3R4Nm9JZHBvNVEKV2ZreldCaE90aG5nd3VzT1pnUGgrTURkZjZzTVlBTjk5ZkRmaVlJQ1JhQldSWHBqWnF1QmY1Y2JoUExDSUU3Zgp0WjIyc014Q1IzSU10ZDE0aGNSV2p2M29PMlEySDdRNkVHYWE2MkorV2pEUjRDa2hzT1V3c1E9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=")
    client_certificate     = base64decode("LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURFekNDQWZ1Z0F3SUJBZ0lJUzFkZ3lYZ0VPSjh3RFFZSktvWklodmNOQVFFTEJRQXdGVEVUTUJFR0ExVUUKQXhNS2EzVmlaWEp1WlhSbGN6QWVGdzB5TVRBME1Ea3lNekUzTURCYUZ3MHlNakEwTURreU16RTNNRFZhTURReApGekFWQmdOVkJBb1REbk41YzNSbGJUcHRZWE4wWlhKek1Sa3dGd1lEVlFRREV4QnJkV0psY201bGRHVnpMV0ZrCmJXbHVNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQTFQRSthUzAxZFB6MkN3T2cKNWY5bWdSZDNScnhZbmpibnpNQTcwV1FTSWNIdkFpRjZIY3NvWHllL091czhoMkJKQ1AxNzQ1bWNTYkhXMEhOYwppMjdFTDlWM1YvNjdMS2YrV3RCUFM1dUFLalRDS0wyNm5xeUIwUmJIdTNvcFRnOXh4OEltVU1sb1FPS1VRQkJ2CjNOYTF2ZUpaUU5GOERuSlU1MG8zQ1EvdSszc3ViK1YrNERrWjhzTnhVZ1MyT3pwN0s5SGxZSXBYb09KUEhYMXIKd05reDArdi9pWVBoSS9lRkV3ZW8xS04zNXFjdjRjZ1ZkREx1bGFXTHpWNWc5ck1HUUVuQkZpZXhJa3R1MnRaLwoxVFloZ0d0YnhML1k4WnpZTjVUUWRMbVlVUkdHVlc3QTBSbXJ4c2FyMWl0ZGcxUVcwS2xOQ0xmblI3bTBFR3B2CmZBeDd0d0lEQVFBQm8wZ3dSakFPQmdOVkhROEJBZjhFQkFNQ0JhQXdFd1lEVlIwbEJBd3dDZ1lJS3dZQkJRVUgKQXdJd0h3WURWUjBqQkJnd0ZvQVU3NkVUTGl1VGRiZmJGTjBzTUEwYWNFZDdlZFl3RFFZSktvWklodmNOQVFFTApCUUFEZ2dFQkFLOVM0TTJDVkZ5c0lpNmJCTmRoWDVWelBsT3lUckNIR2EvZlZUSldVa0pZcmE2OWRmYU8yQklGCnJEYmsxTmZCV2JHeHZWQzVOVjNWakNmYVFQdzN6NmsxWjJRSlFvR0VZWW9FQnN5WkRKQzBaZWxBa2NRK2xOTkMKTFk2aHMyYkZlcjdFcUVpUG1PUlJ4SVlNaU1ic0JFS29LVjdLa09yM2ExODdvd1hiVk9yQkRXSmd3N25wNW1jRQppSHZSeVlNL293d1hILzNwVW1EcGRYSUVaSWtucEduSkU0MVB6TU1KVk9YZFphTFh5L2dndkdzbmdyNzhUVlIxCndPemg5WmFHWmVQbWNVeGRLUitjUFlYY3ExSDZLQUNRMnVrendIeE1seFV5dVNiM0FSbzZUTjRiUVdRQVVJekUKcm83MXZTbTRHREhKNVJBeGFENGp0UTZpeDR3MklMaz0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=")
  }
}

#
# Backend Config (partial)
#
terraform {
  required_version = ">= 0.14.4"

  required_providers {
    aws        = "~> 3.28"
    helm       = "~> 2.1.0"
  }

  backend "s3" {
    key = "apps-devstg/k8s-eks/helm-resources/terraform.tfstate"
  }
}
